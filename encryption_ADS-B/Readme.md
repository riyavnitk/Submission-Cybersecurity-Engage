# Encryption and Filtering Algorithms

## Aircraft Address Message Authentication Code (AA MAC)
The Aircraft Address Message Authentication Code (AA-MAC) security solution utilizes a standard hash algorithm such as MD5 or SHA and a secret authentication key to perform message integrity. The AA-MAC message source integrity scheme would require a slight modification to the existing protocol in that it would replace the current Aircraft Address (AA) field with the MAC, but the ADS-B message is otherwise unchanged.

- In the current ADS-B protocol, each aircraft is assigned a unique 24-bit Aircraft Address that is good for the life of the transponder equipment. The AA-MAC approach proposes a different aircraft identification strategy, assigning a unique identifier to each aircraft that is good for the duration of a particular flight. As with PKI cryptographic approaches, the distribution of the secret key presents challenges for AA-MAC. Several secret key distribution strategies have been proposed for PKI, such as distributing keys to all aircraft enclosed in tamper-proof hardware, utilizing an out-of-channel solution such as a separate dedicated frequency or distributing keys on a per-flight basis. Since MAC requires just one key which is used to uniquely identify a sender on the network, the simplest approach would be to distribute the secret key only when an aircraft intends to enter the air traffic control system and ADS-B network.
- A complication with this approach is that most common hash algorithms generate message authentication codes of 128-bits or more, which means the generated MAC itself is longer than the entire 112-bit 1090ES message. The generated hash needs to be shortened in order to meet the size limitation of the existing protocol. To accomplish this, a sender could compute the MAC using the secret authentication key, and then sequentially XOR the hash in 24-bit blocks (using 0 for padding) to produce a 24-bit MAC. This would then be inserted into the ADS-B message, using the 24-bit space allocated to the AA field.

![AA MAC](https://github.com/riyavnitk/Submission-Cybersecurity-Engage/blob/master/encryption_ADS-B/AA-MAC.png)

## Kalman Filtering for Intent Verification
Kalman filtering is a technique used to filter observations from a noisy data series by providing estimates for the future state of values in the underlying system. The theory behind Kalman filtering requires the observed system to be a linear data series and the underlying input variables to follow a normal distribution. The algorithm is recursive and can efficiently update its estimation values in real time, without having to save more than the last system state. 
- The Kalman filtering procedure comprises three distinct steps; prediction, observation and update. In the first step, the current system state variables are predicted along with a probability estimate of associated uncertainties. The predicted system state values are based on an estimation of the current system state, observations of the state transitions in the system and known system input control variables. The predicted uncertainties are probability estimations based on observations of the state transitions in the system, a system data covariance estimate and an estimate of system process error.
- In the observation step, the system adjusts its estimation values by measuring the residual, which is the discrepancy between the predicted values from the previous step and the currently observed system state values. The observed system values are also used to calculate a residual covariance, based on the probabilities from the previous step and an estimate of system observation measurement error. Finally, the previously obtained estimates are updated with a weighted average, and the estimates with higher probabilities are assigned higher weights.
- This continuous process of prediction, observation and update is a form of feedback control, where the filter estimates the process state at a point in time, and then obtains feedback in the form of noisy measurements. The update step provides the feedback, which incorporates the new observation into the existing estimate to obtain an improved estimate [19]. Thus, a system employing Kalman filtering is constantly updating itself with the most recent observations and revising the values used to compute its estimates.

![Single Variable Kalman Filter](https://github.com/riyavnitk/Submission-Cybersecurity-Engage/blob/master/encryption_ADS-B/Single-variable-Kalman-Filter.png)

- Kalman filtering is currently used in airport ground control systems to help prevent runway incursion incidents and minimize bottlenecks on airport taxiways.